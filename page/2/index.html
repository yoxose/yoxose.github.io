<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 6.3.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"example.com","root":"/","scheme":"Gemini","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta name="description" content="But these are the cards we&#39;ve been dealt, so we might as well play them">
<meta property="og:type" content="website">
<meta property="og:title" content="YOXOSE">
<meta property="og:url" content="http://example.com/page/2/index.html">
<meta property="og:site_name" content="YOXOSE">
<meta property="og:description" content="But these are the cards we&#39;ve been dealt, so we might as well play them">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="yoxose">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="http://example.com/page/2/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : true,
    isPost : false,
    lang   : 'zh-CN'
  };
</script>

  <title>YOXOSE</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">YOXOSE</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content index posts-expand">
            
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2023/03/19/ZoeDepth/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="yoxose">
      <meta itemprop="description" content="But these are the cards we've been dealt, so we might as well play them">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="YOXOSE">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2023/03/19/ZoeDepth/" class="post-title-link" itemprop="url">ZoeDepth</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2023-03-19 16:19:06 / 修改时间：17:09:00" itemprop="dateCreated datePublished" datetime="2023-03-19T16:19:06+08:00">2023-03-19</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/traits/" itemprop="url" rel="index"><span itemprop="name">traits</span></a>
                </span>
                  ，
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/traits/scientificity/" itemprop="url" rel="index"><span itemprop="name">scientificity</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>ZoeDepth can change 2D image to 3D model. </p>
<blockquote>
<p>The <a target="_blank" rel="noopener" href="https://huggingface.co/spaces/shariqfarooq/ZoeDepth">Dome</a> of ZoeDepth.</p>
</blockquote>
<blockquote>
<p>The <a target="_blank" rel="noopener" href="https://colab.research.google.com/github/isl-org/ZoeDepth">google colab</a> of ZoeDepth.</p>
</blockquote>
<blockquote>
<p>The <a target="_blank" rel="noopener" href="https://github.com/isl-org/ZoeDepth">code</a> of ZoeDpeth.</p>
</blockquote>
<blockquote>
<p><a target="_blank" rel="noopener" href="https://doi.org/10.48550/arXiv.2302.12288">Reference</a></p>
</blockquote>
<blockquote>
</blockquote>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2023/03/13/bayes-traits/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="yoxose">
      <meta itemprop="description" content="But these are the cards we've been dealt, so we might as well play them">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="YOXOSE">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2023/03/13/bayes-traits/" class="post-title-link" itemprop="url">bayes_traits</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2023-03-13 17:12:06 / 修改时间：20:50:34" itemprop="dateCreated datePublished" datetime="2023-03-13T17:12:06+08:00">2023-03-13</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/example/" itemprop="url" rel="index"><span itemprop="name">example</span></a>
                </span>
                  ，
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/example/scientificity/" itemprop="url" rel="index"><span itemprop="name">scientificity</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p><em>“The variable rates model allows the rate of change to vary threw time and identifies areas of the tree where the rate of evolution differs significantly, for an in-depth description see (Venditti, Meade et al. 2011). The variable rates model can be used with MultiState, Discrete or any of the independent contrast models. The variable rates model uses RJ MCMC to identify areas of the tree in which the rate of evolution varies significantly”</em></p>
<pre><code>7 # model of analysis, see &lt;BayesTraits V4.0.0&gt; Page 10
2 # MCMC model
Seed 12345
VarRates
Iterations 110000000
BurnIn 10000000
Prior lognormal 0 100
#RJHP gamma 0 100 0 50
#HPAll lognormal 0 100 0 50
#TestPrior 10000
Stones 100 10000
Run 
</code></pre>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2022/10/31/Edit-tree-by-R/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="yoxose">
      <meta itemprop="description" content="But these are the cards we've been dealt, so we might as well play them">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="YOXOSE">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/10/31/Edit-tree-by-R/" class="post-title-link" itemprop="url">Edit_tree_by_R</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2022-10-31 10:02:46 / 修改时间：10:07:45" itemprop="dateCreated datePublished" datetime="2022-10-31T10:02:46+08:00">2022-10-31</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/code/" itemprop="url" rel="index"><span itemprop="name">code</span></a>
                </span>
                  ，
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/code/scientificity/" itemprop="url" rel="index"><span itemprop="name">scientificity</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <pre><code>library(ape)
setwd(&quot;C:/Users/yoxose/Desktop/pedicualris_2022/pedicularis-2022-09/code&quot;)
Timetree &lt;- read.nexus(&quot;pedtimetree.nex&quot;)
plot(Timetree)
nodelabels()
tiplabels()



Timetree &lt;- drop.tip(Timetree, 57:62)
tip &lt;- c(&#39;P_densispica&#39;,&#39;P_rhynchodonta&#39;,&#39;P_rupicola&#39;,&#39;P_stenocorys&#39;,
         &#39;P_glabrescens&#39;,&#39;P_microchila&#39;,&#39;P_decora&#39;,&#39;P_rex&#39;,&#39;P_kansuensis&#39;,
         &#39;P_lutescens&#39;,&#39;P_thamnophila&#39;,&#39;P_lyrata&#39;,&#39;P_roylei&#39;,&#39;P_szetschuanica&#39;,
         &#39;P_nigra&#39;,&#39;P_comptoniaefolia&#39;,&#39;P_tenuisecta&#39;)
Timetree$tip.label



Timetree.YH &lt;- drop.tip(Timetree, tip)
plot(Timetree.YH)
#write.nexus(Timetree.YH,file = &quot;Timetree_YH.nex&quot;)



Timetree.WH &lt;- keep.tip(Timetree, tip)
plot(Timetree.WH)
#write.nexus(Timetree.WH,file = &quot;Timetree_WH.nex&quot;)
</code></pre>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2022/10/26/Check-data/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="yoxose">
      <meta itemprop="description" content="But these are the cards we've been dealt, so we might as well play them">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="YOXOSE">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/10/26/Check-data/" class="post-title-link" itemprop="url">Check data</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2022-10-26 14:57:40" itemprop="dateCreated datePublished" datetime="2022-10-26T14:57:40+08:00">2022-10-26</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2022-10-31 10:18:44" itemprop="dateModified" datetime="2022-10-31T10:18:44+08:00">2022-10-31</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/code/" itemprop="url" rel="index"><span itemprop="name">code</span></a>
                </span>
                  ，
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/code/scientificity/" itemprop="url" rel="index"><span itemprop="name">scientificity</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <span id="more"></span>

<p>Before our analysis, we could check our raw data by Coefficient of Variation (CV) to make sure if it is true or input error.</p>
<pre><code>#read_data----
library(readxl)
setwd(&quot;C:/XX/XX/XX&quot;)
data &lt;- read_excel(&quot;C:/XX/XX/XX.xlsx&quot;)
cal_cv=function(x)&#123;
  y=na.omit(x)
  return(sd(y)/mean(y))
&#125;

data &lt;- as.data.frame(data)
data[,1] &lt;- as.character(data[,1])

#pollen_CV----
data2 &lt;- data.frame()

i &lt;- 1
j &lt;- 1
for (i in 1:56) &#123;
  a &lt;- as.character(data[j,1])
  print(a)
  print(j)
  b &lt;- subset(data,data$名称==a)
  c &lt;- b$pollen
  x &lt;- as.numeric(c)
  print(cal_cv(x))
  print(i)
  data2[i,1] &lt;- a
  data2[i,2] &lt;- j
  data2[i,3] &lt;- cal_cv(x)
  data2[i,4] &lt;- mean(x,na.rm = T)
  j &lt;- j+20
&#125;

#tubeL_CV----
data3 &lt;- data.frame()
i &lt;- 1
j &lt;- 1
for (i in 1:56) &#123;
  a &lt;- as.character(data[j,1])
  print(a)
  print(j)
  b &lt;- subset(data,data$名称==a)
  c &lt;- b$tubeL
  x &lt;- as.numeric(c)
  print(cal_cv(x))
  print(i)
  data3[i,1] &lt;- a
  data3[i,2] &lt;- j
  data3[i,3] &lt;- cal_cv(x)
  data3[i,4] &lt;- mean(x,na.rm = T)
  j &lt;- j+20
&#125; 

#tubeW_CV----
data4 &lt;- data.frame()
i &lt;- 1
j &lt;- 1
for (i in 1:56) &#123;
  a &lt;- as.character(data[j,1])
  print(a)
  print(j)
  b &lt;- subset(data,data$名称==a)
  c &lt;- b$tubeW
  x &lt;- as.numeric(c)
  print(cal_cv(x))
  print(i)
  data4[i,1] &lt;- a
  data4[i,2] &lt;- j
  data4[i,3] &lt;- cal_cv(x)
  data4[i,4] &lt;- mean(x,na.rm = T)
  j &lt;- j+20 
&#125; 

#styleL_CV----
data5 &lt;- data.frame()
i &lt;- 1
j &lt;- 1
for (i in 1:56) &#123;
  a &lt;- as.character(data[j,1])
  print(a)
  print(j)
  b &lt;- subset(data,data$名称==a)
  c &lt;- b$styleL
  x &lt;- as.numeric(c)
  print(cal_cv(x))
  print(i)
  data5[i,1] &lt;- a
  data5[i,2] &lt;- j
  data5[i,3] &lt;- cal_cv(x)
  data5[i,4] &lt;- mean(x,na.rm = T)
  j &lt;- j+20
&#125;
#because tube length should shorter than style length
i &lt;- 1
a &lt;- as.numeric(data$tubeL)
b &lt;- as.numeric(data$styleL)
c &lt;- data.frame()
for (i in 1:1120) &#123;
  if(is.na(a[i]))&#123;
    c[i,1] &lt;- &quot;aNA&quot;
    &#125;else&#123;
      if(is.na(b[i]))&#123;
        c[i,1] &lt;- &quot;bNA&quot;
      &#125;else&#123;
       if(a[i] - b[i]/1000 &lt; 0)&#123;
           c[i,1] &lt;- &quot;true&quot;
         &#125;else&#123;
           c[i,1] &lt;- &quot;false&quot;
        &#125;
      &#125;
    &#125;
&#125;
#styleW_CV----
data6 &lt;- data.frame()

i &lt;- 1
j &lt;- 1
for (i in 1:56) &#123;
  a &lt;- as.character(data[j,1])
  print(a)
  print(j)
  b &lt;- subset(data,data$名称==a)
  c &lt;- b$styleW
  x &lt;- as.numeric(c)
  print(cal_cv(x))
  print(i)
  data6[i,1] &lt;- a
  data6[i,2] &lt;- j
  data6[i,3] &lt;- cal_cv(x)
  data6[i,4] &lt;- mean(x,na.rm = T)
  j &lt;- j+20

&#125;

#depth----
data7 &lt;- data.frame()

i &lt;- 1
j &lt;- 1
for (i in 1:56) &#123;
  a &lt;- as.character(data[j,1])
  print(a)
  print(j)
  b &lt;- subset(data,data$名称==a)
  c &lt;- b$depth
  x &lt;- as.numeric(c)
  print(cal_cv(x))
  print(i)
  data7[i,1] &lt;- a
  data7[i,2] &lt;- j
  data7[i,3] &lt;- cal_cv(x)
  data7[i,4] &lt;- mean(x,na.rm = T)
  j &lt;- j+20
  
&#125;

#wide----
data8 &lt;- data.frame()
    
i &lt;- 1
j &lt;- 1
for (i in 1:56) &#123;
  a &lt;- as.character(data[j,1])
  print(a)
      print(j)
  b &lt;- subset(data,data$名称==a)
  c &lt;- b$wide
  x &lt;- as.numeric(c)
  print(cal_cv(x))
  print(i)
  data8[i,1] &lt;- a
  data8[i,2] &lt;- j
  data8[i,3] &lt;- cal_cv(x)
  data8[i,4] &lt;- mean(x,na.rm = T)
  j &lt;- j+20
  
&#125;

#antherV----
data9 &lt;- data.frame()

i &lt;- 1
j &lt;- 1
for (i in 1:56) &#123;
  a &lt;- as.character(data[j,1])
  print(a)
  print(j)
  b &lt;- subset(data,data$名称==a)
  c &lt;- b$antherV
  x &lt;- as.numeric(c)
  print(cal_cv(x))
  print(i)
  data9[i,1] &lt;- a
  data9[i,2] &lt;- j
  data9[i,3] &lt;- cal_cv(x)
  data9[i,4] &lt;- mean(x,na.rm = T)
  j &lt;- j+20
  
&#125;

#ovuleN----
data10 &lt;- data.frame()

i &lt;- 1
j &lt;- 1
for (i in 1:56) &#123;
  a &lt;- as.character(data[j,1])
  print(a)
  print(j)
  b &lt;- subset(data,data$名称==a)
  c &lt;- b$ovulenumber
  x &lt;- as.numeric(c)
  print(cal_cv(x))
  print(i)
  data10[i,1] &lt;- a
  data10[i,2] &lt;- j
  data10[i,3] &lt;- cal_cv(x)
  data10[i,4] &lt;- mean(x,na.rm = T)
  j &lt;- j+20
  
&#125;

#ovuleV----
data11 &lt;- data.frame()

i &lt;- 1
j &lt;- 1
for (i in 1:56) &#123;
  a &lt;- as.character(data[j,1])
  print(a)
  print(j)
  b &lt;- subset(data,data$名称==a)
  c &lt;- b$ovulesize
  x &lt;- as.numeric(c)
  print(cal_cv(x))
  print(i)
  data11[i,1] &lt;- a
  data11[i,2] &lt;- j
  data11[i,3] &lt;- cal_cv(x)
  data11[i,4] &lt;- mean(x,na.rm = T)
  j &lt;- j+20
  
&#125;

#ovaryL----
data12 &lt;- data.frame()

i &lt;- 1
j &lt;- 1
for (i in 1:56) &#123;
  a &lt;- as.character(data[j,1])
  print(a)
  print(j)
  b &lt;- subset(data,data$名称==a)
  c &lt;- b$ovaryL
  x &lt;- as.numeric(c)
  print(cal_cv(x))
  print(i)
  data12[i,1] &lt;- a
  data12[i,2] &lt;- j
  data12[i,3] &lt;- cal_cv(x)
  data12[i,4] &lt;- mean(x,na.rm = T)
  j &lt;- j+20
  
&#125;

#cycle----
data13 &lt;- data.frame()

i &lt;- 1
j &lt;- 1
for (i in 1:56) &#123;
  a &lt;- as.character(data[j,1])
  print(a)
  print(j)
  b &lt;- subset(data,data$名称==a)
  c &lt;- b$cycle
  x &lt;- as.numeric(c)
  print(cal_cv(x))
  print(i)
  data13[i,1] &lt;- a
  data13[i,2] &lt;- j
  data13[i,3] &lt;- cal_cv(x)
  data13[i,4] &lt;- mean(x,na.rm = T)
  j &lt;- j+20
  
&#125;

#P/E----
data14 &lt;- data.frame()

i &lt;- 1
j &lt;- 1
for (i in 1:56) &#123;
  a &lt;- as.character(data[j,1])
  print(a)
  print(j)
  b &lt;- subset(data,data$名称==a)
  c &lt;- b$`P/E`
  x &lt;- as.numeric(c)
  print(cal_cv(x))
  print(i)
  data14[i,1] &lt;- a
  data14[i,2] &lt;- j
  data14[i,3] &lt;- cal_cv(x)
  data14[i,4] &lt;- mean(x,na.rm = T)
  j &lt;- j+20
  
&#125;
</code></pre>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2022/10/21/correlationship-between-pollen-number-and-anther-volume/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="yoxose">
      <meta itemprop="description" content="But these are the cards we've been dealt, so we might as well play them">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="YOXOSE">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/10/21/correlationship-between-pollen-number-and-anther-volume/" class="post-title-link" itemprop="url">correlationship between pollen number and anther volume</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2022-10-21 10:50:02 / 修改时间：12:36:49" itemprop="dateCreated datePublished" datetime="2022-10-21T10:50:02+08:00">2022-10-21</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/code/" itemprop="url" rel="index"><span itemprop="name">code</span></a>
                </span>
                  ，
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/code/scientificity/" itemprop="url" rel="index"><span itemprop="name">scientificity</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <pre><code>#read data ----
#install.packages(&quot;readxl&quot;)
library(readxl)
setwd(&quot;C:/Users/yoxose/Desktop/pedicualris_2022/pedicularis-2022-09/code&quot;)
#getwd()
data &lt;- read_excel(&quot;C:/Users/yoxose/Desktop/pedicualris_2022/pedicularis-2022-09/pedicularis_pollen_anther.xlsx&quot;,
               sheet = 2)
data &lt;- data[,-4]

#Coefficient of Variation ----
cal_cv=function(x)&#123;
    y=na.omit(x)
    return(sd(y)/mean(y))
&#125;

data2 &lt;- read_excel(&quot;C:/Users/yoxose/Desktop/pedicualris_2022/pedicularis-2022-09/pedicularis_pollen_anther.xlsx&quot;,
                sheet = 3)
class(data$species)
data2 &lt;- as.data.frame(data2)
data2[,1] &lt;- as.character(data2[,1])
data3 &lt;- data.frame()

i &lt;- 1
j &lt;- 1
for (i in 1:54) &#123;
    a &lt;- as.character(data2[j,1])
    print(a)
    print(j)
    b &lt;- subset(data2,data2$species==a)
    c &lt;- b$all
    x &lt;- as.numeric(c)
    print(cal_cv(x))
    print(i)
    data3[i,1] &lt;- a
    data3[i,2] &lt;- j
    data3[i,3] &lt;- cal_cv(x)
    data3[i,4] &lt;- mean(x,na.rm = T) 
    if(as.character(data2[j+10,1])==a)&#123;j &lt;- j+11
        &#125;else&#123;
        j &lt;- j+10
    &#125;
&#125;
#与data比较，验证data3结果是否对应正确
plnm1 &lt;- round(data3$V4)
plnm2 &lt;- na.omit(round(as.numeric(data$pollenN_mean)))
class(plnm1)
plnm1==plnm2

#write.table(data3, file = &quot;pollenN_CV.csv&quot;, quote = F, sep = &quot;,&quot;)

data4 &lt;- read_excel(&quot;C:/Users/yoxose/Desktop/pedicualris_2022/pedicularis-2022-09/pedicularis_pollen_anther.xlsx&quot;,
                sheet = 4)

data4 &lt;- as.data.frame(data4)
data4[,1] &lt;- as.character(data4[,1])
data5 &lt;- data.frame()

i &lt;- 1
j &lt;- 1
for (i in 1:56) &#123;
    a4 &lt;- as.character(data4[j,1])
    print(a4)
    print(j)
    b4 &lt;- subset(data4,data4$species==a4)
    c4 &lt;- b4$antherV
    x &lt;- as.numeric(c4)
    print(cal_cv(x))
    print(i)
    data5[i,1] &lt;- a4
    data5[i,2] &lt;- j
    data5[i,3] &lt;- cal_cv(x)
    data5[i,4] &lt;- mean(x,na.rm = T)
    j &lt;- j+20
&#125;

plnm3 &lt;- round(as.numeric(data5$V4),digits = 6)
plnm4 &lt;- round(na.omit(as.numeric(data4$anther_M)),digits = 6)
plnm3==plnm4


#correlationship -----

anV &lt;- data$antherV_mean
plN &lt;- round(as.numeric(data$pollenN_mean), digits = 0)
lm &lt;- lm(anV ~ plN)
summary(lm)
plot(lm)

#plot ----
#install.packages(&quot;ggplot2&quot;)
library(ggplot2)
ggplot(data, aes(x = plN, y = anV)) + 
geom_point() +
stat_smooth(method = &quot;lm&quot;, col = &quot;red&quot;)

ggplotRegression &lt;- function (fit) &#123;

     require(ggplot2)

    ggplot(fit$model, aes_string(x = names(fit$model)[2], y = names(fit$model)[1])) + 
        geom_point(colour = &quot;black&quot;,size = 3, alpha = 0.3) +
        stat_smooth(method = &quot;lm&quot;, col = &quot;blue&quot;) +
        labs(title = paste(&quot;Adj R2 = &quot;,signif(summary(fit)$adj.r.squared, 5),
                   &quot;Intercept =&quot;,signif(fit$coef[[1]],5 ),
                   &quot; Slope =&quot;,signif(fit$coef[[2]], 5),
                   &quot; P =&quot;,signif(summary(fit)$coef[2,4], 5)))
&#125;

ggplotRegression(lm)
</code></pre>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2022/10/19/count-circular-genome-ratio/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="yoxose">
      <meta itemprop="description" content="But these are the cards we've been dealt, so we might as well play them">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="YOXOSE">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/10/19/count-circular-genome-ratio/" class="post-title-link" itemprop="url">count circular genome ratio</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2022-10-19 11:04:29" itemprop="dateCreated datePublished" datetime="2022-10-19T11:04:29+08:00">2022-10-19</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2022-10-21 12:30:17" itemprop="dateModified" datetime="2022-10-21T12:30:17+08:00">2022-10-21</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/code/" itemprop="url" rel="index"><span itemprop="name">code</span></a>
                </span>
                  ，
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/code/scientificity/" itemprop="url" rel="index"><span itemprop="name">scientificity</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>A script for count circular genome ratio efficiently:</p>
<pre><code>echo $(ls) &gt; flist.txt #to confrim the length of loop according to the numbers of folders

list=$(cat flist.txt) #read the list and assign a variable for loop

#a loop for getting the final result from the logfile
for i in $list;do
cd $&#123;i&#125;;
cd results;
a=$(sudo cat get_org.log.txt |grep -o &quot;Result status of embplant_pt.*&quot;);
b=$&#123;i&#125;;
cd ..;
cd ..;
echo $b &gt;&gt; GOR.txt;
echo $a &gt;&gt; GOR.txt;
done

grep -o &#39;S18&#39; GOR.txt |wc -l #to count the sum of input sequences

grep -o &#39;circular genome&#39; GOR.txt |wc -l #to count the sum of circular genome
</code></pre>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2022/10/12/upload-sequence-to-NCBI/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="yoxose">
      <meta itemprop="description" content="But these are the cards we've been dealt, so we might as well play them">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="YOXOSE">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/10/12/upload-sequence-to-NCBI/" class="post-title-link" itemprop="url">upload sequence to NCBI</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2022-10-12 10:35:35 / 修改时间：12:32:26" itemprop="dateCreated datePublished" datetime="2022-10-12T10:35:35+08:00">2022-10-12</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/example/" itemprop="url" rel="index"><span itemprop="name">example</span></a>
                </span>
                  ，
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/example/scientificity/" itemprop="url" rel="index"><span itemprop="name">scientificity</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>Sometimes, when we finish the assembly and annotation, we want to upload them to a common database as GenBank. So this is an example for how to upload a sequence to GenBank.</p>
<h3 id="Upload-raw-data"><a href="#Upload-raw-data" class="headerlink" title="Upload raw data"></a>Upload raw data</h3><p>I refer to this blog: <a target="_blank" rel="noopener" href="https://cloud.tencent.com/developer/article/1806824">最新 （2021版_Windows）| 测序原始数据上传NCBI的详细过程 - 腾讯云开发者社区-腾讯云 (tencent.com)</a></p>
<h3 id="Use-BankIt-to-submit-sequence-with-annotation"><a href="#Use-BankIt-to-submit-sequence-with-annotation" class="headerlink" title="Use BankIt to submit sequence with annotation"></a>Use BankIt to submit sequence with annotation</h3><p>I refer to this blog: <a target="_blank" rel="noopener" href="https://www.biomart.cn/experiment/430/590/597/57949.htm">如何利用BankIt向NCBI在线提交序列</a>, and use this web: <a target="_blank" rel="noopener" href="https://chlorobox.mpimp-golm.mpg.de/GenBank2Sequin.html">MPI-MP CHLOROBOX - GB2sequin (mpg.de)</a> to generate the feature table.</p>
<p><em><strong>If there are any mistakes, Plase contact me (<a href="mailto:&#x77;&#97;&#x6e;&#x67;&#119;&#x65;&#105;&#106;&#105;&#x61;&#54;&#57;&#x40;&#x31;&#54;&#x33;&#46;&#99;&#111;&#109;">&#x77;&#97;&#x6e;&#x67;&#119;&#x65;&#105;&#106;&#105;&#x61;&#54;&#57;&#x40;&#x31;&#54;&#x33;&#46;&#99;&#111;&#109;</a>). Thank you for your help to improve the quality of my article!</strong></em></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2022/10/11/Annotation-genome/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="yoxose">
      <meta itemprop="description" content="But these are the cards we've been dealt, so we might as well play them">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="YOXOSE">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/10/11/Annotation-genome/" class="post-title-link" itemprop="url">Genome-Annotation</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2022-10-11 23:13:33" itemprop="dateCreated datePublished" datetime="2022-10-11T23:13:33+08:00">2022-10-11</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2022-10-12 00:25:27" itemprop="dateModified" datetime="2022-10-12T00:25:27+08:00">2022-10-12</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/example/" itemprop="url" rel="index"><span itemprop="name">example</span></a>
                </span>
                  ，
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/example/scientificity/" itemprop="url" rel="index"><span itemprop="name">scientificity</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>After we assemble the cycle of chloroplast genome, we can use PGA and Geneious to annotate them before uploading to GeneBank.</p>
<h3 id="PGA-annotation"><a href="#PGA-annotation" class="headerlink" title="PGA annotation"></a>PGA annotation</h3><p><em>“PGA (Plastid Genome Annotator), a standalone command line tool, can perform rapid, accurate, and flexible batch annotation of newly generated target plastomes based on well-annotated reference plastomes.”</em> This is the introduction to PGA of its <a target="_blank" rel="noopener" href="https://github.com/quxiaojian/PGA">web</a>. </p>
<pre><code>#install perl
wget https://www.cpan.org/src/5.0/perl-5.36.0.tar.gz
tar -xzf perl-5.36.0.tar.gz
cd perl-5.36.0
./Configure -des -Dprefix=$HOME/localperl
make
make test
make install

#intall BLAST 
wget https://ftp.ncbi.nlm.nih.gov/blast/executables/blast+/LATEST/ncbi-blast-2.13.0+-x64-linux.tar.gz
tar -xzf ncbi-blast-2.13.0+-x64-linux.tar.gz

#add PATH
vim ~/.bashrc
export PATH=/home/ZYH/Desktop/wwj/PGA/#####blast的文件夹名称/bin:$PATH
source ~/.bashrc

blastn -version

#download PGA
git clone https://github.com/quxiaojian/PGA.git
vim ~/.bashrc
export PATH=/home/xxx/PGA:$PATH
source ~/.bashrc
chmod a+rwx PGA.pl

perl PGA.pl -r reference -t data/pedicularis_fasta
</code></pre>
<h3 id="Geneious-annotation"><a href="#Geneious-annotation" class="headerlink" title="Geneious annotation"></a>Geneious annotation</h3><p><a target="_blank" rel="noopener" href="https://www.geneious.com/prime/">Geneious</a> - Comprehensive suite of molecular biology and sequence analysis tools</p>
<blockquote>
<p>creating a reference folder, put reference sequence which has annotated in it.<br>your sequences -&gt; Annotate &amp; Predict -&gt; Annotate from database</p>
</blockquote>
<p>when you finish the annotation, you may find some parts of you sequences are opposite direction, you need adjust them by “Copy Reverse Complement” of right click menu. And because there two path results of one chloroplast genome, you may find the location of genes of your sequence are very different from reference. At this case, you also need adjust them, but editing the sequence must be careful.</p>
<p><em><strong>If there are any mistakes, Plase contact me (<a href="mailto:&#119;&#97;&#x6e;&#x67;&#x77;&#x65;&#105;&#x6a;&#x69;&#97;&#x36;&#57;&#64;&#x31;&#54;&#51;&#x2e;&#x63;&#x6f;&#x6d;">&#119;&#97;&#x6e;&#x67;&#x77;&#x65;&#105;&#x6a;&#x69;&#97;&#x36;&#57;&#64;&#x31;&#54;&#51;&#x2e;&#x63;&#x6f;&#x6d;</a>). Thank you for your help to improve the quality of my article!</strong></em></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2022/10/11/getorganelle/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="yoxose">
      <meta itemprop="description" content="But these are the cards we've been dealt, so we might as well play them">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="YOXOSE">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/10/11/getorganelle/" class="post-title-link" itemprop="url">getorganelle</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2022-10-11 14:32:15" itemprop="dateCreated datePublished" datetime="2022-10-11T14:32:15+08:00">2022-10-11</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2022-10-12 00:25:20" itemprop="dateModified" datetime="2022-10-12T00:25:20+08:00">2022-10-12</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/example/" itemprop="url" rel="index"><span itemprop="name">example</span></a>
                </span>
                  ，
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/example/scientificity/" itemprop="url" rel="index"><span itemprop="name">scientificity</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>When we get the raw data of genome skimming, we can use GetOrganelle to assemble organelle genome.</p>
<h3 id="Download-miniconda3"><a href="#Download-miniconda3" class="headerlink" title="Download miniconda3"></a>Download miniconda3</h3><p>From the web of <a target="_blank" rel="noopener" href="https://docs.conda.io/en/latest/miniconda.html">Miniconda3</a>, we can know that <em>“Miniconda is a free minimal installer for conda. It is a small, bootstrap version of Anaconda that includes only conda, Python, the packages they depend on, and a small number of other useful packages, including pip, zlib and a few others. Use the <code>conda install</code> command to install 720+ additional conda packages from the Anaconda repository.”</em> So, before install Getorganelle, we download miniconda3 on linux system firstly.</p>
<blockquote>
<p>If you want to insatll it from command line, you can refer to the following from <a target="_blank" rel="noopener" href="https://jungleblack007.github.io/2021/08/30/%E4%BB%8E%E6%B5%85%E5%B1%82%E5%9F%BA%E5%9B%A0%E7%BB%84%E6%B5%8B%E5%BA%8F%E5%88%B0%E7%B3%BB%E7%BB%9F%E5%8F%91%E8%82%B2%E6%A0%91%E7%9A%84%E6%9E%84%E5%BB%BA/">jungleblack007</a> :</p>
</blockquote>
<pre><code>wget -c https://repo.continuum.io/miniconda/Miniconda3-latest-Linux-x86_64.sh
chmod 777 Miniconda3-latest-Linux-x86_64.sh
bash Miniconda3-latest-Linux-x86_64.sh

cd miniconda3/bin
chmod 777 activate
. ./activate
conda list

#add mirrors
conda config --add channels https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/free/
conda config --add channels https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/main/
conda config --add channels https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud/conda-forge/
conda config --add channels https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud/bioconda/
</code></pre>
<h3 id="Install-getorganelle"><a href="#Install-getorganelle" class="headerlink" title="Install getorganelle"></a>Install getorganelle</h3><p>This web of GetOrganelle -<a target="_blank" rel="noopener" href="https://github.com/Kinggerm/GetOrganelle">GitHub - Kinggerm&#x2F;GetOrganelle: Organelle Genome Assembly Toolkit (Chloroplast&#x2F;Mitocondrial&#x2F;ITS)</a>- introduces how to install GetOrganelle by miniconda3</p>
<pre><code>#create an operating environment
conda create -n getorganelle
source activate getorganelle

#install getorganelle
conda install getorganelle

#add reference sequence bank
get_organelle_config.py --add embplant_pt,embplant_mt
#if false, trying the following:
wget https://github.com/Kinggerm/GetOrganelleDB/releases/download/0.0.1/v0.0.1.tar.gz
tar -zxvf v0.0.1.tar.gz
get_organelle_config.py -a embplant_pt,embplant_mt --use-local ./0.0.1
</code></pre>
<h3 id="Opetate-getorganelle"><a href="#Opetate-getorganelle" class="headerlink" title="Opetate getorganelle"></a>Opetate getorganelle</h3><pre><code>list=$(cat list.txt)

for i in $list;do
cd $&#123;i&#125;;
get_organelle_from_reads.py -1 *1.fq.gz -2 *2.fq.gz -F embplant_pt -w 0.65 -o results -R 10 -t 10 -k 21,33,55,85,105,127;
cd ..;
done
</code></pre>
<p>When we get the results, we use <strong>Bandage</strong> to estimate the quality.</p>
<blockquote>
<p>file -&gt; load graph -&gt; xxxx.complete.graph1.selected_graph.gfa -&gt; draw graph</p>
</blockquote>
<p>If the quality is good, we can upload the <em>xxxx.complete.graph1.1.path_sequence.fasta</em> or <em>.complete.graph1.2.path_sequence.fasta</em> to <strong>Geneious</strong>. If not, the following may help:</p>
<blockquote>
<p>Graph display -&gt; colour by depth</p>
</blockquote>
<blockquote>
<p>file -&gt; load graph -&gt; xxxx.complete.graph1.selected_graph.gfa -&gt; load CSV data -&gt; draw graph -&gt; node labels -&gt; CSV data</p>
</blockquote>
<p>If the graph appear fragment, we can output all fragments to <strong>Geneious</strong> and annotation or BLAST them.</p>
<p><em><strong>If there are any mistakes, Plase contact me (<a href="mailto:&#x77;&#97;&#110;&#103;&#x77;&#x65;&#x69;&#x6a;&#x69;&#97;&#x36;&#x39;&#x40;&#x31;&#x36;&#51;&#46;&#x63;&#111;&#x6d;">&#x77;&#97;&#110;&#103;&#x77;&#x65;&#x69;&#x6a;&#x69;&#97;&#x36;&#x39;&#x40;&#x31;&#x36;&#51;&#46;&#x63;&#111;&#x6d;</a>). Thank you for your help to improve the quality of my article!</strong></em></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2022/10/06/Construct-a-phylogenetic-tree/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="yoxose">
      <meta itemprop="description" content="But these are the cards we've been dealt, so we might as well play them">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="YOXOSE">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/10/06/Construct-a-phylogenetic-tree/" class="post-title-link" itemprop="url">Construct a phylogenetic tree</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2022-10-06 16:46:40" itemprop="dateCreated datePublished" datetime="2022-10-06T16:46:40+08:00">2022-10-06</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2022-10-10 17:38:44" itemprop="dateModified" datetime="2022-10-10T17:38:44+08:00">2022-10-10</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/example/" itemprop="url" rel="index"><span itemprop="name">example</span></a>
                </span>
                  ，
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/example/scientificity/" itemprop="url" rel="index"><span itemprop="name">scientificity</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>This is an example about how to use DNA sequences to create a phylogenetic tree for beginner. If there are any mistakes, Plase contact me (<a href="mailto:&#x77;&#97;&#x6e;&#x67;&#119;&#101;&#x69;&#106;&#105;&#x61;&#x36;&#x39;&#x40;&#49;&#54;&#51;&#x2e;&#x63;&#x6f;&#x6d;">&#x77;&#97;&#x6e;&#x67;&#119;&#101;&#x69;&#106;&#105;&#x61;&#x36;&#x39;&#x40;&#49;&#54;&#51;&#x2e;&#x63;&#x6f;&#x6d;</a>). Thank you for your help to improve the quality of my article! </p>
<h2 id="PREPARE-SEQUENCES"><a href="#PREPARE-SEQUENCES" class="headerlink" title="PREPARE SEQUENCES"></a>PREPARE SEQUENCES</h2><h3 id="Download-sequence-from-NCBI"><a href="#Download-sequence-from-NCBI" class="headerlink" title="Download sequence from NCBI"></a>Download sequence from NCBI</h3><p>Many times, we can not get all DNA sequence which needed in our research by ourselves’ sample. So, in this case, we need the help of public database as GeneBank.</p>
<p>If you now the number of species that you want to use in the research, you can go to this web - <a target="_blank" rel="noopener" href="https://www.ncbi.nlm.nih.gov/">National Center for Biotechnology Information (nih.gov)</a> to download the sequesce. For example, in my study, I want a chloroplast genome of <em>Pedicularis nigra</em> and I know the number of this species as <strong>OL544940</strong>, it is easy to find the sequence which I need by <strong>search box</strong> in the web. </p>
<p>But the accurate numbers of our species are also hard found sometimes, in this situations, we can search the species names directly and click <strong>Nucleotide</strong>–on the left bottom of result page to find the sequence.</p>
<blockquote>
<p>species name&#x2F;number -&gt; ‘search’ -&gt; ‘Nucleotide’ -&gt; the sequence -&gt; ‘Send to’ -&gt; ‘File’</p>
</blockquote>
<p>PS: Even in same species, the sequences also have a few differences, but how to find the sequence,  we could find the one which is most close located in where your sample collected.</p>
<h3 id="Change-sequence-ID"><a href="#Change-sequence-ID" class="headerlink" title="Change sequence ID"></a>Change sequence ID</h3><p>When we downlod so many sequences and change their names in <strong>Geneious</strong>, it is too hard for us to rename thousands of sequences. To make that easier, we can use <strong>TBtools</strong> to change the names of sequences. How to use the TBtools, you can refer to my vedio– <a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV19g4y1B7GJ/?spm_id_from=333.999.0.0&vd_source=37eccaba6801cfc7a4547c68a9bb7e4a">change the ID</a> or any other instruction of TBtools.</p>
<h3 id="Modify-the-sequence"><a href="#Modify-the-sequence" class="headerlink" title="Modify the sequence"></a>Modify the sequence</h3><p>After we downlod all the sequences which we use in our research,  the multiple alignment program for amino acid or nucleotide sequences will be used. We can get the program from the link-<a target="_blank" rel="noopener" href="https://mafft.cbrc.jp/alignment/software/">MAFFT - a multiple sequence alignment program (cbrc.jp)</a> and learn how to use it: <a target="_blank" rel="noopener" href="https://academic.oup.com/mbe/article/30/4/772/1073398?login=true">MAFFT Multiple Sequence Alignment Software Version 7: Improvements in Performance and Usability </a></p>
<p>Finishing the MAFFT operation, we can use trimAL to clip the output of MAFFT. There is a introduction of trimAL–<a target="_blank" rel="noopener" href="http://trimal.cgenomics.org/introduction">introduction [trimAl]</a>.</p>
<h3 id="Construct-the-maximum-likehood-phylogenetic-tree-by-RAxML"><a href="#Construct-the-maximum-likehood-phylogenetic-tree-by-RAxML" class="headerlink" title="Construct the maximum likehood phylogenetic  tree by RAxML"></a>Construct the maximum likehood phylogenetic  tree by RAxML</h3><p>When we get the final matrix of sequences with fasta format, we can use <a target="_blank" rel="noopener" href="https://antonellilab.github.io/raxmlGUI/">raxmlGUI 2.0</a> to construct the ML tree. And also can use <a target="_blank" rel="noopener" href="https://github.com/stamatak/standard-RAxML">raxmlHPC-PTHREADS-SSE3 </a> with linux system.</p>
<pre><code>wget https://github.com/stamatak/standard-RAxML/archive/v8.2.12.tar.gz 
tar zxf RAxML-v8.2.12.tar.gz
cd RAxML-8.2.12/
make -f Makefile.SSE3.PTHREADS.gcc -j 4
rm *.o
make -f Makefile.AVX.PTHREADS.gcc -j 4
rm *.o
echo &#39;PATH=$PATH:/(your-own-path)/RAxML-8.2.12/&#39; &gt;&gt; ~/.bashrc
source ~/.bashrc
</code></pre>
<p>Example:</p>
<pre><code>raxmlHPC-PTHREADS-SSE3 -T 10 -f a -x 12345 -p 12345 -N 1000 -m GTRGAMMA -k -O -n output.tre -s &quot;**input&quot; -w &quot;**output&quot;
</code></pre>
<p>From all output results, choose the <strong>RAxML_bipartitions</strong> to see the bootstrap value on every nodes by <a target="_blank" rel="noopener" href="http://tree.bio.ed.ac.uk/software/Figtree/">Figtree</a>.</p>
<h3 id="Construct-the-bayesian-inference-tree-by-MrBayes"><a href="#Construct-the-bayesian-inference-tree-by-MrBayes" class="headerlink" title="Construct the bayesian inference tree by MrBayes"></a>Construct the bayesian inference tree by MrBayes</h3><p>we use <strong>Modeltest-ng</strong> of raxmlGUI to estimate the beat-fit model. Than, we edit the “NEX” file, add the follow code at the end of file:</p>
<pre><code>begin mrbayes;
log start filename = log_its.txt;
outgroup ****;
outgroup ****;
lset nst=6 rates=*best-fit model*;
prset statefreqpr = fixed(*,*,*,*) shapepr = fixed(*) revmat = fixed(*,*,*,*,*);
mcmcp ngen=2000000 printfreq=1000 samplefreq=100 nchains=4 nruns=2 savebrlens=yes checkpoint=yes checkfreq=5000;
mcmc;
sumt conformat=Simple contype=Halfcompat relburnin=yes burninfrac=0.25;
sump relburnin=yes burninfrac=0.25;
end;
</code></pre>
<p>Finally, we use <strong>MPI</strong> and <strong>Mrbayes</strong> on Linux system to construct BI tree with multi-thread.</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  


  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/"><i class="fa fa-angle-left" aria-label="上一页"></i></a><a class="page-number" href="/">1</a><span class="page-number current">2</span><a class="page-number" href="/page/3/">3</a><a class="extend next" rel="next" href="/page/3/"><i class="fa fa-angle-right" aria-label="下一页"></i></a>
  </nav>



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">yoxose</p>
  <div class="site-description" itemprop="description">But these are the cards we've been dealt, so we might as well play them</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">21</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
        <span class="site-state-item-count">6</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
        <span class="site-state-item-count">23</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2024</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">yoxose</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Gemini</a> 强力驱动
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  















  

  

</body>
</html>
